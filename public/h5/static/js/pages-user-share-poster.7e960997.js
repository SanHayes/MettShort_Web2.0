(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-share-poster"],{"0106":function(t,e,n){var a=n("90d1");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=n("4f06").default;o("216eb434",a,!0,{sourceMap:!1,shadowMode:!1})},"236f":function(t,e,n){"use strict";n.r(e);var a=n("4e15"),o=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},"377d":function(t,e,n){"use strict";n.r(e);var a=n("4e1d"),o=n("236f");for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var s=n("ffe9");for(var i in s)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(i);n("37f6");var r=n("f0c5");o["default"].__module="canvasImage";var c=Object(r["a"])(s["default"],a["b"],a["c"],!1,null,"86c0e4f2",null,!1,a["a"],o["default"]);e["default"]=c.exports},"37f6":function(t,e,n){"use strict";var a=n("0106"),o=n.n(a);o.a},"4e15":function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("1834")),i={data:function(){return{isCanDraw:!0}},methods:{generateImage:function(){var t=this.$ownerInstance;t.callMethod("_showLoading","");var e=setTimeout((function(){var n=document.getElementById("pagePoster");(0,o.default)(n,{width:n.clientWidth,height:n.clientHeight-6,scrollY:0,scrollX:0,useCORS:!0,scale:3}).then((function(e){t.callMethod("receiveRenderData",e.toDataURL("image/png")),t.callMethod("_hideLoading")})).catch((function(e){t.callMethod("_errAlert","".concat(e)),t.callMethod("_hideLoading")})),clearTimeout(e)}),300)},logicToView:function(t,e){!0===t&&!0===this.isCanDraw&&(this.isCanDraw=!1,this.generateImage())}}};e.default=i},"4e1d":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var a={tkiQrcode:n("ab64").default},o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"page_content"},[n("v-uni-view",{staticClass:"head_content"},[n("CustomNavbar",{attrs:{title:t.$t("navbar.poster")}})],1),n("v-uni-view",{staticClass:"main_content",style:{background:t.backgroundColor}},[n("v-uni-view",{wxsProps:{"change:msg":"qrcodeDrawFinish"},staticClass:"poster share_canvas",attrs:{id:"pagePoster",msg:t.qrcodeDrawFinish,"change:msg":t.canvasImage.logicToView}},[n("img",{staticClass:"image draw_canvas",attrs:{src:t.posterBackground,mode:"widthFix","data-mode":"widthFix","data-type":"image","data-url":t.posterBackground,"data-base64":"1"},on:{load:function(e){arguments[0]=e=t.$handleEvent(e),t.loadImg("posterBackground")}}}),n("img",{staticClass:"qrcode draw_canvas",attrs:{src:t.posterQrcode,mode:"aspectFill","data-mode":"aspectFill","data-type":"image","data-url":t.posterQrcode,"data-base64":"1"},on:{load:function(e){arguments[0]=e=t.$handleEvent(e),t.loadImg("posterQrcode")}}})]),n("v-uni-view",{staticClass:"poster1"},[n("v-uni-image",{staticClass:"preview_img",attrs:{src:t.posterImg,mode:"widthFix","show-menu-by-longpress":!0}})],1),n("tki-qrcode",{ref:"inviteQrcode",attrs:{cid:"invite-qrcode",val:t.qrcodeValue,size:260,show:!1,loadMake:!0,showLoading:!1},on:{result:function(e){arguments[0]=e=t.$handleEvent(e),t.qrcodeResult.apply(void 0,arguments)}}}),n("v-uni-canvas",{staticClass:"canvas_style",style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px"},attrs:{"canvas-id":"myCanvas"}}),t.qrcodeDrawFinish?n("v-uni-view",{staticClass:"rule_box"},[n("v-uni-view",{staticClass:"info"},[n("v-uni-view",{staticClass:"title"},[t._v(t._s(t.$t("poster.invite")))]),n("v-uni-view",{staticClass:"msg"},[t._v(t._s(t.$t("poster.desc1"))),n("br"),t._v(t._s(t.$t("poster.desc2")))])],1),n("v-uni-view",{staticClass:"button",style:"background:"+t.global.isColor},[t._v(t._s(t.$t("poster.save")))])],1):t._e()],1)],1)},i=[]},"90d1":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.page_content .main_content[data-v-86c0e4f2]{flex:auto;overflow-y:auto;background:#6a62d1;position:relative;padding-bottom:%?60?%}.page_content .main_content .poster[data-v-86c0e4f2]{position:relative}.page_content .main_content .poster .image[data-v-86c0e4f2]{width:100%}.page_content .main_content .poster .qrcode[data-v-86c0e4f2]{position:absolute;bottom:%?108?%;left:%?66?%;width:%?140?%;height:%?140?%}.page_content .main_content .poster1[data-v-86c0e4f2]{position:absolute;top:0;left:0;z-index:1;width:100%}.page_content .main_content .poster1 .preview_img[data-v-86c0e4f2]{width:100%}.page_content .main_content .rule_box[data-v-86c0e4f2]{padding:0 %?36?%}.page_content .main_content .rule_box .info[data-v-86c0e4f2]{border:%?4?% solid #000;padding:%?20?% %?30?%;background:#fff;color:#000}.page_content .main_content .rule_box .info .title[data-v-86c0e4f2]{font-size:%?28?%;margin-bottom:%?10?%}.page_content .main_content .rule_box .info .msg[data-v-86c0e4f2]{font-size:%?24?%;line-height:%?40?%}.page_content .main_content .rule_box .button[data-v-86c0e4f2]{width:100%;height:%?80?%;line-height:%?80?%;color:#fff;font-size:%?32?%;background:#df9b45;border-radius:%?16?%;text-align:center;margin-top:%?-24?%}.page_content .main_content .canvas_style[data-v-86c0e4f2]{position:fixed;top:%?-999999999?%;left:0}',""]),t.exports=e},a501:function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("99af"),n("14d9"),n("ac1f"),n("5319");var o=a(n("5530")),i=n("cf68"),s=a(n("ab64")),r=n("26cb"),c={components:{tkiQrcode:s.default},data:function(){return{global:getApp().globalData,posterBackground:"",backgroundColor:"",posterImg:"",canvasWidth:0,canvasHeight:0,qrcodeValue:"",posterQrcode:"",qrcodeDrawFinish:!1,imageLoadFinish:[],UID:this.$store.state.user.uid||0}},computed:(0,o.default)((0,o.default)({},(0,r.mapGetters)("user",["uid"])),(0,r.mapGetters)("app",["config"])),watch:{uid:function(t,e){this.UID=t,this.shareLink()}},onLoad:function(){uni.showLoading({mask:!0}),this.initData()},onReady:function(){},methods:{initData:function(){var t,e,n,a,o=(null===(t=this.config)||void 0===t||null===(e=t.share)||void 0===e?void 0:e.user_poster_bg)||"/pages/user/static/poster.png";this.backgroundColor=null===(n=this.config)||void 0===n||null===(a=n.share)||void 0===a?void 0:a.user_poster_bg_color,this.turnBase64Image(o,"posterBackground"),this.shareLink()},shareLink:function(){if(this.UID){var t=this.UID+".1.0.1.2";this.qrcodeValue=window.location.origin+window.location.pathname+"?sign=".concat(this.$SIGN,"#/pages/home/index?scene=").concat(t)}},loadImg:function(t){this.imageLoadFinish.push(t),2===this.imageLoadFinish.length&&(this.qrcodeDrawFinish=!0)},qrcodeResult:function(t){t&&this.turnBase64Image(t,"posterQrcode")},turnBase64Image:function(t,e){var n=this;uni.getImageInfo({src:t,success:function(t){(0,i.pathToBase64)(t.path).then((function(t){n[e]=t})).catch((function(t){console.log("base 64 error: ",t)}))},fail:function(t){console.log("getImageInfo error: ",t)}})},receiveRenderData:function(t){var e=t.replace(/[\r\n]/g,"");this.posterImg=e},_showLoading:function(t){uni.showLoading({})},_hideLoading:function(){uni.hideLoading()},_errAlert:function(t){uni.showModal({title:this.$t("modal.system"),content:t,cancelText:this.$t("text.cancel"),confirmText:this.$t("text.confirm")})}}};e.default=c},ffe9:function(t,e,n){"use strict";n.r(e);var a=n("a501"),o=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a}}]);